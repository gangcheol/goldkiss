<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="CIC">
<meta name="dcterms.date" content="2021-02-03">

<title>Goldkiss - 04. image DA (3)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../posts/image/2021-02-05-06. DeepLearningwithMNIST.html" rel="next">
<link href="../../posts/image/2021-02-02-04. ImageAugmentation2.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../posts/image/2021-01-29-01. CNNwithCIFAR10.html">Image</a></li><li class="breadcrumb-item"><a href="../../posts/image/2021-02-03-05. ImageAugmentation3.html">04. image DA (3)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">04. image DA (3)</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>CIC </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 3, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Goldkiss</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Advanced</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/advanced/2024-01-08-04. MNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04. MNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/advanced/2024-01-21-00. Associate review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Associate Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/advanced/2024-01-22-01. 텍스트 분류.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. 텍스트 분류</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/advanced/2024-01-22-02.이미지_분류.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. 이미지 분류</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Basic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/basic/2023-10-30-00. Churn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. Churn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/basic/2023-10-31-01. VOC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. VOC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/basic/2023-11-01-02. iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. iris</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/basic/2023-11-01-03. Titanic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. Titanic</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Image</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-01-29-01. CNNwithCIFAR10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00. CIFAR10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-01-30-02. CNNwithMNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01. MNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-01-03. ImageAugmentation1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02. image DA (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-02-04. ImageAugmentation2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03. image DA (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-03-05. ImageAugmentation3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">04. image DA (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-05-06. DeepLearningwithMNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05. MNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-07-07. PretrainedModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06. pretrained Model (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/image/2021-02-08-08. PretrainedModel_and_Tuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07. pretrained Model (2)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#image-data-augmentation-with-cifar-100" id="toc-image-data-augmentation-with-cifar-100" class="nav-link active" data-scroll-target="#image-data-augmentation-with-cifar-100">Image Data Augmentation with CIFAR-100</a>
  <ul class="collapse">
  <li><a href="#data-loading" id="toc-data-loading" class="nav-link" data-scroll-target="#data-loading">Data Loading</a></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">Data Preprocessing</a></li>
  <li><a href="#image-data-augmentation" id="toc-image-data-augmentation" class="nav-link" data-scroll-target="#image-data-augmentation"><strong>Image Data Augmentation</strong></a></li>
  <li><a href="#modeling-cnn" id="toc-modeling-cnn" class="nav-link" data-scroll-target="#modeling-cnn">Modeling : CNN</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="image-data-augmentation-with-cifar-100" class="level1">
<h1>Image Data Augmentation with CIFAR-100</h1>
<section id="data-loading" class="level2">
<h2 class="anchored" data-anchor-id="data-loading">Data Loading</h2>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3102,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694759486965,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">from</span> tensorflow.keras.datasets.cifar100 <span class="im">import</span> load_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6599,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694759497124,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="63b361cb-1467-4a64-be71-c017d4942cbd" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>(train_x, train_y), (test_x, test_y) <span class="op">=</span> load_data()</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># (train_x, train_y), (test_x, test_y) = load_data(label_mode='coarse')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading data from https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz
169001437/169001437 [==============================] - 4s 0us/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694759497124,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="4ce01ff8-8f9b-43f9-e236-f0afb303f810" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>np.unique(train_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
       85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:262,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694759511986,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="81dcae0b-2ef9-4d92-90dd-1449249913bd" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>label_dict <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'apple'</span>, <span class="dv">1</span>: <span class="st">'aquarium_fish'</span>, <span class="dv">2</span>: <span class="st">'baby'</span>, <span class="dv">3</span>: <span class="st">'bear'</span>, <span class="dv">4</span>: <span class="st">'beaver'</span>, <span class="dv">5</span>: <span class="st">'bed'</span>, <span class="dv">6</span>: <span class="st">'bee'</span>, <span class="dv">7</span>: <span class="st">'beetle'</span>, <span class="dv">8</span>: <span class="st">'bicycle'</span>, <span class="dv">9</span>: <span class="st">'bottle'</span>,</span>
<span id="cb6-2"><a href="#cb6-2"></a>              <span class="dv">10</span>: <span class="st">'bowl'</span>, <span class="dv">11</span>: <span class="st">'boy'</span>,<span class="dv">12</span>: <span class="st">'bridge'</span>,<span class="dv">13</span>: <span class="st">'bus'</span>,<span class="dv">14</span>: <span class="st">'butterfly'</span>,<span class="dv">15</span>: <span class="st">'camel'</span>,<span class="dv">16</span>: <span class="st">'can'</span>,<span class="dv">17</span>: <span class="st">'castle'</span>,<span class="dv">18</span>: <span class="st">'caterpillar'</span>,<span class="dv">19</span>: <span class="st">'cattle'</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>              <span class="dv">20</span>: <span class="st">'chair'</span>,<span class="dv">21</span>: <span class="st">'chimpanzee'</span>,<span class="dv">22</span>: <span class="st">'clock'</span>,<span class="dv">23</span>: <span class="st">'cloud'</span>,<span class="dv">24</span>: <span class="st">'cockroach'</span>,<span class="dv">25</span>: <span class="st">'couch'</span>,<span class="dv">26</span>: <span class="st">'cra'</span>,<span class="dv">27</span>: <span class="st">'crocodile'</span>,<span class="dv">28</span>: <span class="st">'cup'</span>,<span class="dv">29</span>: <span class="st">'dinosaur'</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>              <span class="dv">30</span>: <span class="st">'dolphin'</span>,<span class="dv">31</span>: <span class="st">'elephant'</span>,<span class="dv">32</span>: <span class="st">'flatfish'</span>,<span class="dv">33</span>: <span class="st">'forest'</span>,<span class="dv">34</span>: <span class="st">'fox'</span>,<span class="dv">35</span>: <span class="st">'girl'</span>,<span class="dv">36</span>: <span class="st">'hamster'</span>,<span class="dv">37</span>: <span class="st">'house'</span>,<span class="dv">38</span>: <span class="st">'kangaroo'</span>,<span class="dv">39</span>: <span class="st">'keyboard'</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>              <span class="dv">40</span>: <span class="st">'lamp'</span>,<span class="dv">41</span>: <span class="st">'lawn_mower'</span>,<span class="dv">42</span>: <span class="st">'leopard'</span>,<span class="dv">43</span>: <span class="st">'lion'</span>,<span class="dv">44</span>: <span class="st">'lizard'</span>,<span class="dv">45</span>: <span class="st">'lobster'</span>,<span class="dv">46</span>: <span class="st">'man'</span>,<span class="dv">47</span>: <span class="st">'maple_tree'</span>,<span class="dv">48</span>: <span class="st">'motorcycle'</span>,<span class="dv">49</span>: <span class="st">'mountain'</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>              <span class="dv">50</span>: <span class="st">'mouse'</span>,<span class="dv">51</span>: <span class="st">'mushroom'</span>,<span class="dv">52</span>: <span class="st">'oak_tree'</span>,<span class="dv">53</span>: <span class="st">'orange'</span>,<span class="dv">54</span>: <span class="st">'orchid'</span>,<span class="dv">55</span>: <span class="st">'otter'</span>,<span class="dv">56</span>: <span class="st">'palm_tree'</span>,<span class="dv">57</span>: <span class="st">'pear'</span>,<span class="dv">58</span>: <span class="st">'pickup_truck'</span>,<span class="dv">59</span>: <span class="st">'pine_tree'</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>              <span class="dv">60</span>: <span class="st">'plain'</span>,<span class="dv">61</span>: <span class="st">'plate'</span>,<span class="dv">62</span>: <span class="st">'poppy'</span>,<span class="dv">63</span>: <span class="st">'porcupine'</span>,<span class="dv">64</span>: <span class="st">'possum'</span>,<span class="dv">65</span>: <span class="st">'rabbit'</span>,<span class="dv">66</span>: <span class="st">'raccoon'</span>,<span class="dv">67</span>: <span class="st">'ray'</span>,<span class="dv">68</span>: <span class="st">'road'</span>,<span class="dv">69</span>: <span class="st">'rocket'</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>              <span class="dv">70</span>: <span class="st">'rose'</span>,<span class="dv">71</span>: <span class="st">'sea'</span>,<span class="dv">72</span>: <span class="st">'seal'</span>,<span class="dv">73</span>: <span class="st">'shark'</span>,<span class="dv">74</span>: <span class="st">'shrew'</span>,<span class="dv">75</span>: <span class="st">'skunk'</span>,<span class="dv">76</span>: <span class="st">'skyscraper'</span>,<span class="dv">77</span>: <span class="st">'snail'</span>,<span class="dv">78</span>: <span class="st">'snake'</span>,<span class="dv">79</span>: <span class="st">'spider'</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>              <span class="dv">80</span>: <span class="st">'squirrel'</span>,<span class="dv">81</span>: <span class="st">'streetcar'</span>,<span class="dv">82</span>: <span class="st">'sunflower'</span>,<span class="dv">83</span>: <span class="st">'sweet_pepper'</span>,<span class="dv">84</span>: <span class="st">'table'</span>,<span class="dv">85</span>: <span class="st">'tank'</span>,<span class="dv">86</span>: <span class="st">'telephone'</span>,<span class="dv">87</span>: <span class="st">'television'</span>,<span class="dv">88</span>: <span class="st">'tiger'</span>,<span class="dv">89</span>: <span class="st">'tractor'</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>              <span class="dv">90</span>: <span class="st">'train'</span>,<span class="dv">91</span>: <span class="st">'trout'</span>,<span class="dv">92</span>: <span class="st">'tulip'</span>,<span class="dv">93</span>: <span class="st">'turtle'</span>,<span class="dv">94</span>: <span class="st">'wardrobe'</span>,<span class="dv">95</span>: <span class="st">'whale'</span>,<span class="dv">96</span>: <span class="st">'willow_tree'</span>,<span class="dv">97</span>: <span class="st">'wolf'</span>,<span class="dv">98</span>: <span class="st">'woman'</span>,<span class="dv">99</span>: <span class="st">'worm'</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>            }</span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a>label_dict[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'apple'</code></pre>
</div>
</div>
<ul>
<li>데이터 살펴보기</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:408,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761564357,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="e6bea266-8046-43d6-8b26-8ede4ad0611b" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>rand_i <span class="op">=</span> np.random.randint(<span class="dv">0</span>, train_x.shape[<span class="dv">0</span>])</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>plt.title(<span class="ss">f'idx: </span><span class="sc">{</span>rand_i<span class="sc">}</span><span class="ss"> , class: </span><span class="sc">{</span> label_dict[train_y[rand_i][<span class="dv">0</span>]] <span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>plt.imshow( train_x[rand_i] )</span>
<span id="cb8-5"><a href="#cb8-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2021-02-03-05. ImageAugmentation3_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:15133,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694759571634,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="c8208edc-69d9-4529-e29a-d4cc4f90f432" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>rows <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>fig, axes <span class="op">=</span> plt.subplots(rows, <span class="bu">len</span>(label_dict), figsize<span class="op">=</span>(<span class="bu">len</span>(label_dict), rows) )</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="cf">for</span> img_id <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(label_dict)) :</span>
<span id="cb9-5"><a href="#cb9-5"></a>    imgs <span class="op">=</span> train_x[train_y.reshape(<span class="op">-</span><span class="dv">1</span>)<span class="op">==</span>img_id]</span>
<span id="cb9-6"><a href="#cb9-6"></a>    imgs_len <span class="op">=</span> <span class="bu">len</span>(imgs)</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="cf">for</span> row_i <span class="kw">in</span> <span class="bu">range</span>(rows) :</span>
<span id="cb9-9"><a href="#cb9-9"></a>        axe <span class="op">=</span> axes[row_i, img_id]</span>
<span id="cb9-10"><a href="#cb9-10"></a>        axe.imshow( imgs[np.random.randint(imgs_len)], interpolation<span class="op">=</span><span class="st">'none'</span> )</span>
<span id="cb9-11"><a href="#cb9-11"></a>        axe.axis(<span class="st">'off'</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a>plt.tight_layout()</span>
<span id="cb9-14"><a href="#cb9-14"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
</section>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing</h2>
<ul>
<li>Data split
<ul>
<li>training set : test set = 8 : 2</li>
<li>training set : validation set = 8 : 2</li>
<li>재현을 위한 난수 고정 : 2023</li>
</ul></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761596744,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split <span class="im">as</span> tts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:283,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761655958,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>train_x, val_x, train_y, val_y <span class="op">=</span> tts(train_x, train_y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">2023</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761661418,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="40aaf20b-92fa-424e-ad8b-16bc4ac263ea" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>train_x.shape, train_y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>((40000, 32, 32, 3), (40000, 1))</code></pre>
</div>
</div>
<ul>
<li><p>Scaling</p>
<ul>
<li>min-max scaling (선택사항)
<ol type="1">
<li>RGB 정보 전체를 min-max</li>
<li>R 따로 G 따로 B 따로 min-max, 그 후 하나로 통합</li>
</ol></li>
</ul></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:250,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761715493,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="346f539b-171d-4ca2-b983-45f3fc6f1072" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># min-max scaling 1번 방법</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>max_n, min_n <span class="op">=</span> train_x.<span class="bu">max</span>(), train_x.<span class="bu">min</span>()</span>
<span id="cb15-3"><a href="#cb15-3"></a>max_n, min_n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(255, 0)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:673,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761798159,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>train_x_mm1 <span class="op">=</span> (train_x <span class="op">-</span> min_n) <span class="op">/</span> (max_n <span class="op">-</span> min_n)</span>
<span id="cb17-2"><a href="#cb17-2"></a>val_x_mm1 <span class="op">=</span> (val_x <span class="op">-</span> min_n) <span class="op">/</span> (max_n <span class="op">-</span> min_n)</span>
<span id="cb17-3"><a href="#cb17-3"></a>test_x_mm1 <span class="op">=</span> (test_x <span class="op">-</span> min_n) <span class="op">/</span> (max_n <span class="op">-</span> min_n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:255,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761814277,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="c73941f2-e5a6-44d1-e5a2-c76e4eed9275" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>train_x_mm1.<span class="bu">max</span>(), train_x_mm1.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(1.0, 0.0)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:418,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761899209,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># min-max scaling 2번 방법</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>tr_r_max, tr_r_min <span class="op">=</span> train_x[:,:,:,<span class="dv">0</span>].<span class="bu">max</span>(), train_x[:,:,:,<span class="dv">0</span>].<span class="bu">min</span>()</span>
<span id="cb20-3"><a href="#cb20-3"></a>tr_g_max, tr_g_min <span class="op">=</span> train_x[:,:,:,<span class="dv">1</span>].<span class="bu">max</span>(), train_x[:,:,:,<span class="dv">1</span>].<span class="bu">min</span>()</span>
<span id="cb20-4"><a href="#cb20-4"></a>tr_b_max, tr_b_min <span class="op">=</span> train_x[:,:,:,<span class="dv">2</span>].<span class="bu">max</span>(), train_x[:,:,:,<span class="dv">2</span>].<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:689,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694761985243,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>train_r_mm <span class="op">=</span> (train_x[:,:,:,<span class="dv">0</span>] <span class="op">-</span> tr_r_min) <span class="op">/</span> (tr_r_max <span class="op">-</span> tr_r_min)</span>
<span id="cb21-2"><a href="#cb21-2"></a>train_g_mm <span class="op">=</span> (train_x[:,:,:,<span class="dv">1</span>] <span class="op">-</span> tr_g_min) <span class="op">/</span> (tr_g_max <span class="op">-</span> tr_g_min)</span>
<span id="cb21-3"><a href="#cb21-3"></a>train_b_mm <span class="op">=</span> (train_x[:,:,:,<span class="dv">2</span>] <span class="op">-</span> tr_b_min) <span class="op">/</span> (tr_b_max <span class="op">-</span> tr_b_min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:675,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762014735,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>train_x_mm <span class="op">=</span> np.stack((train_r_mm, train_g_mm, train_b_mm), axis<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:269,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762017888,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="43c286ad-7328-4147-e051-21ebf220190b" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>train_x_mm.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>(40000, 32, 32, 3)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:262,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762096790,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>val_r_mm <span class="op">=</span> (val_x[:,:,:,<span class="dv">0</span>] <span class="op">-</span> tr_r_min) <span class="op">/</span> (tr_r_max <span class="op">-</span> tr_r_min)</span>
<span id="cb25-2"><a href="#cb25-2"></a>val_g_mm <span class="op">=</span> (val_x[:,:,:,<span class="dv">1</span>] <span class="op">-</span> tr_g_min) <span class="op">/</span> (tr_g_max <span class="op">-</span> tr_g_min)</span>
<span id="cb25-3"><a href="#cb25-3"></a>val_b_mm <span class="op">=</span> (val_x[:,:,:,<span class="dv">2</span>] <span class="op">-</span> tr_b_min) <span class="op">/</span> (tr_b_max <span class="op">-</span> tr_b_min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:286,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762097993,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>val_x_mm <span class="op">=</span> np.stack((val_r_mm, val_g_mm, val_b_mm), axis<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:258,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762103138,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="817163d7-0214-4156-b9bd-e433580f40cf" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>val_x_mm.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>(10000, 32, 32, 3)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:252,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762145099,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>test_r_mm <span class="op">=</span> (test_x[:,:,:,<span class="dv">0</span>] <span class="op">-</span> tr_r_min) <span class="op">/</span> (tr_r_max <span class="op">-</span> tr_r_min)</span>
<span id="cb29-2"><a href="#cb29-2"></a>test_g_mm <span class="op">=</span> (test_x[:,:,:,<span class="dv">1</span>] <span class="op">-</span> tr_g_min) <span class="op">/</span> (tr_g_max <span class="op">-</span> tr_g_min)</span>
<span id="cb29-3"><a href="#cb29-3"></a>test_b_mm <span class="op">=</span> (test_x[:,:,:,<span class="dv">2</span>] <span class="op">-</span> tr_b_min) <span class="op">/</span> (tr_b_max <span class="op">-</span> tr_b_min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:234,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762167600,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>test_x_mm <span class="op">=</span> np.stack((test_r_mm, test_g_mm, test_b_mm), axis<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:284,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762170628,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="0338c901-ab5c-4216-fd1d-4af8df781af4" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>test_x_mm.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(10000, 32, 32, 3)</code></pre>
</div>
</div>
<ul>
<li>One-hot encoding</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>train_y.shape</span>
<span id="cb33-2"><a href="#cb33-2"></a>train_y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:254,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762276673,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>class_n <span class="op">=</span> <span class="bu">len</span>(np.unique(train_y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:251,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762291058,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:375,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762318613,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="33">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>train_y <span class="op">=</span> to_categorical(train_y, class_n)</span>
<span id="cb36-2"><a href="#cb36-2"></a>val_y <span class="op">=</span> to_categorical(val_y, class_n)</span>
<span id="cb36-3"><a href="#cb36-3"></a>test_y <span class="op">=</span> to_categorical(test_y, class_n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Data shape 재확인</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:273,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762326864,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="e6a0e219-2ad2-49b4-c337-53cffdcdb0d8" data-execution_count="34">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>train_x_mm.shape, train_y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>((40000, 32, 32, 3), (40000, 100))</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:266,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694762341806,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="fcee0899-8f78-4c53-bbd8-680a5e3afcf9" data-execution_count="35">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>train_y[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
      dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="image-data-augmentation" class="level2">
<h2 class="anchored" data-anchor-id="image-data-augmentation"><strong>Image Data Augmentation</strong></h2>
<ul>
<li>ImageDataGenerator : <a href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator"><strong>전체 옵션 참고</strong></a></li>
<li>.flow( )</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:240,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694763108900,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="36">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:320,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694763288688,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>trainIDG <span class="op">=</span> ImageDataGenerator(rotation_range<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb42-2"><a href="#cb42-2"></a>                              width_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb42-3"><a href="#cb42-3"></a>                              height_shift_range<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb42-4"><a href="#cb42-4"></a>                              shear_range<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>                              zoom_range<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb42-6"><a href="#cb42-6"></a>                              )</span>
<span id="cb42-7"><a href="#cb42-7"></a></span>
<span id="cb42-8"><a href="#cb42-8"></a>valIDG <span class="op">=</span> ImageDataGenerator()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:299,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694763361131,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>flow_trainIDG <span class="op">=</span> trainIDG.flow(train_x_mm, train_y)</span>
<span id="cb43-2"><a href="#cb43-2"></a>flow_valIDG <span class="op">=</span> valIDG.flow(val_x_mm, val_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modeling-cnn" class="level2">
<h2 class="anchored" data-anchor-id="modeling-cnn">Modeling : CNN</h2>
<ul>
<li>조건
<ol type="1">
<li>Sequential API, Functiona API 중 택일.</li>
<li><a href="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&amp;fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99DFA5415B38AC752E">이 구조를 미니 버전으로 활용해봐도 좋다.</a></li>
<li>DropOut, BatchNormalization 등의 기능도 같이 활용해보자.</li>
<li>Early Stopping을 사용할 것.</li>
</ol></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694763447232,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="40">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="im">from</span> tensorflow.keras.backend <span class="im">import</span> clear_session</span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Model</span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Input, Dense, Flatten, BatchNormalization, Dropout</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv2D, MaxPool2D</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:266,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764096778,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="47">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Functional API</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co"># 1. 세션 클리어</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>clear_session()</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co"># 2. 레이어 엮기</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>il <span class="op">=</span> Input(shape<span class="op">=</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">3</span>) )</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a>hl <span class="op">=</span> Conv2D(filters<span class="op">=</span><span class="dv">64</span>,        <span class="co"># 새롭게 제작하려는 feature map의 수! 서로 다른 filter의 수</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>            kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="co"># Conv filter의 가로세로 사이즈</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>            strides<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>),     <span class="co"># Conv filter의 이동 보폭</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>            padding<span class="op">=</span><span class="st">'same'</span>,    <span class="co"># 1. 이전 feature map 사이즈 유지 | 2. 외곽 정보 더 반영</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>            activation<span class="op">=</span><span class="st">'relu'</span>  <span class="co"># 명시 주의!</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>            )(il)</span>
<span id="cb45-14"><a href="#cb45-14"></a>hl <span class="op">=</span> Conv2D(filters<span class="op">=</span><span class="dv">64</span>,        <span class="co"># 새롭게 제작하려는 feature map의 수! 서로 다른 filter의 수</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>            kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="co"># Conv filter의 가로세로 사이즈</span></span>
<span id="cb45-16"><a href="#cb45-16"></a>            strides<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>),     <span class="co"># Conv filter의 이동 보폭</span></span>
<span id="cb45-17"><a href="#cb45-17"></a>            padding<span class="op">=</span><span class="st">'same'</span>,    <span class="co"># 1. 이전 feature map 사이즈 유지 | 2. 외곽 정보 더 반영</span></span>
<span id="cb45-18"><a href="#cb45-18"></a>            activation<span class="op">=</span><span class="st">'relu'</span>  <span class="co"># 명시 주의!</span></span>
<span id="cb45-19"><a href="#cb45-19"></a>            )(hl)</span>
<span id="cb45-20"><a href="#cb45-20"></a>hl <span class="op">=</span> MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="co"># Pool filter 가로세로 사이즈</span></span>
<span id="cb45-21"><a href="#cb45-21"></a>               strides<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)   <span class="co"># Pool filter의 이동 보폭</span></span>
<span id="cb45-22"><a href="#cb45-22"></a>               )(hl)</span>
<span id="cb45-23"><a href="#cb45-23"></a>hl <span class="op">=</span> BatchNormalization()(hl)</span>
<span id="cb45-24"><a href="#cb45-24"></a>hl <span class="op">=</span> Dropout(<span class="fl">0.5</span>)(hl)</span>
<span id="cb45-25"><a href="#cb45-25"></a></span>
<span id="cb45-26"><a href="#cb45-26"></a>hl <span class="op">=</span> Conv2D(filters<span class="op">=</span><span class="dv">128</span>,        <span class="co"># 새롭게 제작하려는 feature map의 수! 서로 다른 filter의 수</span></span>
<span id="cb45-27"><a href="#cb45-27"></a>            kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="co"># Conv filter의 가로세로 사이즈</span></span>
<span id="cb45-28"><a href="#cb45-28"></a>            strides<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>),     <span class="co"># Conv filter의 이동 보폭</span></span>
<span id="cb45-29"><a href="#cb45-29"></a>            padding<span class="op">=</span><span class="st">'same'</span>,    <span class="co"># 1. 이전 feature map 사이즈 유지 | 2. 외곽 정보 더 반영</span></span>
<span id="cb45-30"><a href="#cb45-30"></a>            activation<span class="op">=</span><span class="st">'relu'</span>  <span class="co"># 명시 주의!</span></span>
<span id="cb45-31"><a href="#cb45-31"></a>            )(hl)</span>
<span id="cb45-32"><a href="#cb45-32"></a>hl <span class="op">=</span> Conv2D(filters<span class="op">=</span><span class="dv">128</span>,        <span class="co"># 새롭게 제작하려는 feature map의 수! 서로 다른 filter의 수</span></span>
<span id="cb45-33"><a href="#cb45-33"></a>            kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="co"># Conv filter의 가로세로 사이즈</span></span>
<span id="cb45-34"><a href="#cb45-34"></a>            strides<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>),     <span class="co"># Conv filter의 이동 보폭</span></span>
<span id="cb45-35"><a href="#cb45-35"></a>            padding<span class="op">=</span><span class="st">'same'</span>,    <span class="co"># 1. 이전 feature map 사이즈 유지 | 2. 외곽 정보 더 반영</span></span>
<span id="cb45-36"><a href="#cb45-36"></a>            activation<span class="op">=</span><span class="st">'relu'</span>  <span class="co"># 명시 주의!</span></span>
<span id="cb45-37"><a href="#cb45-37"></a>            )(hl)</span>
<span id="cb45-38"><a href="#cb45-38"></a>hl <span class="op">=</span> MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="co"># Pool filter 가로세로 사이즈</span></span>
<span id="cb45-39"><a href="#cb45-39"></a>               strides<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)   <span class="co"># Pool filter의 이동 보폭</span></span>
<span id="cb45-40"><a href="#cb45-40"></a>               )(hl)</span>
<span id="cb45-41"><a href="#cb45-41"></a>hl <span class="op">=</span> BatchNormalization()(hl)</span>
<span id="cb45-42"><a href="#cb45-42"></a>hl <span class="op">=</span> Dropout(<span class="fl">0.5</span>)(hl)</span>
<span id="cb45-43"><a href="#cb45-43"></a></span>
<span id="cb45-44"><a href="#cb45-44"></a>hl <span class="op">=</span> Flatten()(hl)</span>
<span id="cb45-45"><a href="#cb45-45"></a>hl <span class="op">=</span> Dense(<span class="dv">1024</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(hl)</span>
<span id="cb45-46"><a href="#cb45-46"></a>ol <span class="op">=</span> Dense(<span class="dv">100</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)(hl)</span>
<span id="cb45-47"><a href="#cb45-47"></a></span>
<span id="cb45-48"><a href="#cb45-48"></a><span class="co"># 3. 모델 시작과 끝 지정</span></span>
<span id="cb45-49"><a href="#cb45-49"></a>model <span class="op">=</span> Model(il, ol)</span>
<span id="cb45-50"><a href="#cb45-50"></a></span>
<span id="cb45-51"><a href="#cb45-51"></a><span class="co"># 4. 컴파일</span></span>
<span id="cb45-52"><a href="#cb45-52"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span>keras.losses.categorical_crossentropy,</span>
<span id="cb45-53"><a href="#cb45-53"></a>              metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694763886343,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="c94f8d40-3f13-44fc-d6b6-d7401ac223cd" data-execution_count="43">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 32, 32, 3)]       0         
                                                                 
 conv2d (Conv2D)             (None, 32, 32, 64)        1792      
                                                                 
 conv2d_1 (Conv2D)           (None, 32, 32, 64)        36928     
                                                                 
 max_pooling2d (MaxPooling2  (None, 16, 16, 64)        0         
 D)                                                              
                                                                 
 batch_normalization (Batch  (None, 16, 16, 64)        256       
 Normalization)                                                  
                                                                 
 dropout (Dropout)           (None, 16, 16, 64)        0         
                                                                 
 conv2d_2 (Conv2D)           (None, 16, 16, 128)       73856     
                                                                 
 conv2d_3 (Conv2D)           (None, 16, 16, 128)       147584    
                                                                 
 max_pooling2d_1 (MaxPoolin  (None, 8, 8, 128)         0         
 g2D)                                                            
                                                                 
 batch_normalization_1 (Bat  (None, 8, 8, 128)         512       
 chNormalization)                                                
                                                                 
 dropout_1 (Dropout)         (None, 8, 8, 128)         0         
                                                                 
 flatten (Flatten)           (None, 8192)              0         
                                                                 
 dense (Dense)               (None, 1024)              8389632   
                                                                 
 dense_1 (Dense)             (None, 100)               102500    
                                                                 
=================================================================
Total params: 8753060 (33.39 MB)
Trainable params: 8752676 (33.39 MB)
Non-trainable params: 384 (1.50 KB)
_________________________________________________________________</code></pre>
</div>
</div>
<ul>
<li>Early Stopping</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:909,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764103019,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="48">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764103975,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>es <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,       <span class="co"># 얼리스토핑 적용할 관측 대상</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>                   min_delta<span class="op">=</span><span class="dv">0</span>,              <span class="co"># 임계값.</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>                   patience<span class="op">=</span><span class="dv">3</span>,               <span class="co"># 성능 개선 미발생시 몇 epoch 더 진행할 것인가.</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>                   verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a>                   restore_best_weights<span class="op">=</span><span class="va">True</span> <span class="co"># 가장 성능 좋은 epoch의 가중치로 되돌림</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>.fit( )
<ul>
<li>Data Augmentation 과정에서 생성한 ImageDataGenerator를 사용해야 한다.</li>
</ul></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:361290,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1694764512406,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="15f34f10-0f7b-4a68-fb75-62330dbf1990" data-execution_count="50">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>model.fit(flow_trainIDG,                <span class="co"># 위에서 만든 ImageDataGenerator 사용!</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>          validation_data<span class="op">=</span>flow_valIDG,  <span class="co"># validation data도 ImageDataGenerator 사용!</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>          epochs<span class="op">=</span><span class="dv">10000</span>, verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb50-4"><a href="#cb50-4"></a>          callbacks<span class="op">=</span>[es]                <span class="co"># 얼리스토핑 적용!</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10000
1250/1250 [==============================] - 45s 26ms/step - loss: 4.0804 - accuracy: 0.0841 - val_loss: 4.0402 - val_accuracy: 0.1054
Epoch 2/10000
1250/1250 [==============================] - 32s 26ms/step - loss: 3.5838 - accuracy: 0.1485 - val_loss: 3.4358 - val_accuracy: 0.1836
Epoch 3/10000
1250/1250 [==============================] - 31s 25ms/step - loss: 3.3809 - accuracy: 0.1827 - val_loss: 3.6172 - val_accuracy: 0.1628
Epoch 4/10000
1250/1250 [==============================] - 32s 25ms/step - loss: 3.2250 - accuracy: 0.2094 - val_loss: 3.0372 - val_accuracy: 0.2392
Epoch 5/10000
1250/1250 [==============================] - 31s 25ms/step - loss: 3.1083 - accuracy: 0.2301 - val_loss: 3.2196 - val_accuracy: 0.2268
Epoch 6/10000
1250/1250 [==============================] - 31s 25ms/step - loss: 3.0036 - accuracy: 0.2521 - val_loss: 2.9238 - val_accuracy: 0.2734
Epoch 7/10000
1250/1250 [==============================] - 32s 26ms/step - loss: 2.9174 - accuracy: 0.2672 - val_loss: 2.6553 - val_accuracy: 0.3242
Epoch 8/10000
1250/1250 [==============================] - 32s 25ms/step - loss: 2.8519 - accuracy: 0.2797 - val_loss: 2.7759 - val_accuracy: 0.3153
Epoch 9/10000
1250/1250 [==============================] - 31s 25ms/step - loss: 2.7779 - accuracy: 0.2913 - val_loss: 2.5782 - val_accuracy: 0.3433
Epoch 10/10000
1250/1250 [==============================] - 32s 26ms/step - loss: 2.7133 - accuracy: 0.3062 - val_loss: 2.6364 - val_accuracy: 0.3373
Epoch 11/10000
 151/1250 [==&gt;...........................] - ETA: 24s - loss: 2.6425 - accuracy: 0.3239</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>KeyboardInterrupt: ignored</code></pre>
</div>
</div>
<ul>
<li>.evaluate( )</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2082,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764529950,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="16830a05-1fad-487d-9d5c-fe7c108cff77" data-execution_count="51">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>model.evaluate(test_x_mm, test_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 [==============================] - 1s 4ms/step - loss: 2.8866 - accuracy: 0.3080</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>[2.886594533920288, 0.30799999833106995]</code></pre>
</div>
</div>
<ul>
<li>.predict( )</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2028,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764545994,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="31b57561-8e47-4b4b-aec1-72fbfa049721" data-execution_count="52">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>y_pred <span class="op">=</span> model.predict(test_x_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 [==============================] - 1s 3ms/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:258,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764565002,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="53">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># 원핫 인코딩 한 것을 다시 묶어주는 코드</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="co"># 평가 지표 및 실제 데이터 확인을 위해 필요</span></span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a>y_pred_arg <span class="op">=</span> np.argmax(y_pred, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-5"><a href="#cb58-5"></a>test_y_arg <span class="op">=</span> np.argmax(test_y, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:257,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764569187,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="b886935d-d0d3-46fd-e403-5d826c42fab1" data-execution_count="54">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>y_pred_arg[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>79</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:279,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764586145,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="141ab162-e803-47ea-dfe6-e6a45da81422" data-execution_count="56">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>test_y_arg[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>49</code></pre>
</div>
</div>
<ul>
<li>평가 지표</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:314,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764593676,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-execution_count="57">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764594060,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="72999144-12d9-4e15-f321-3cd2b91c4f4b" data-execution_count="58">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>accuracy_score(test_y_arg, y_pred_arg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>0.308</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764594383,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="e3c49328-2570-4403-a077-e0a27a82701c" data-execution_count="59">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a><span class="bu">print</span>( classification_report(test_y_arg, y_pred_arg, target_names<span class="op">=</span><span class="bu">list</span>(label_dict.values())) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               precision    recall  f1-score   support

        apple       0.81      0.46      0.59       100
aquarium_fish       0.62      0.24      0.35       100
         baby       0.32      0.20      0.25       100
         bear       0.38      0.12      0.18       100
       beaver       0.12      0.08      0.10       100
          bed       0.47      0.21      0.29       100
          bee       0.25      0.47      0.33       100
       beetle       0.34      0.47      0.39       100
      bicycle       0.33      0.32      0.32       100
       bottle       0.77      0.20      0.32       100
         bowl       0.34      0.13      0.19       100
          boy       0.49      0.23      0.31       100
       bridge       0.52      0.23      0.32       100
          bus       0.46      0.19      0.27       100
    butterfly       0.33      0.10      0.15       100
        camel       0.25      0.16      0.20       100
          can       0.63      0.24      0.35       100
       castle       0.51      0.31      0.39       100
  caterpillar       0.50      0.08      0.14       100
       cattle       0.38      0.18      0.24       100
        chair       0.41      0.69      0.51       100
   chimpanzee       0.50      0.30      0.37       100
        clock       0.20      0.30      0.24       100
        cloud       0.61      0.53      0.57       100
    cockroach       0.43      0.57      0.49       100
        couch       0.35      0.13      0.19       100
          cra       0.17      0.37      0.23       100
    crocodile       0.19      0.13      0.15       100
          cup       0.61      0.35      0.45       100
     dinosaur       0.26      0.39      0.31       100
      dolphin       0.34      0.33      0.34       100
     elephant       0.42      0.18      0.25       100
     flatfish       0.37      0.18      0.24       100
       forest       0.54      0.38      0.45       100
          fox       0.09      0.15      0.11       100
         girl       0.26      0.05      0.08       100
      hamster       0.28      0.29      0.29       100
        house       0.40      0.35      0.37       100
     kangaroo       0.12      0.13      0.12       100
     keyboard       0.14      0.65      0.23       100
         lamp       0.50      0.17      0.25       100
   lawn_mower       0.73      0.60      0.66       100
      leopard       0.07      0.75      0.13       100
         lion       0.16      0.23      0.19       100
       lizard       0.14      0.12      0.13       100
      lobster       0.14      0.12      0.13       100
          man       0.37      0.15      0.21       100
   maple_tree       0.35      0.40      0.38       100
   motorcycle       0.49      0.59      0.53       100
     mountain       0.47      0.40      0.43       100
        mouse       0.17      0.07      0.10       100
     mushroom       0.20      0.36      0.26       100
     oak_tree       0.26      0.89      0.40       100
       orange       0.60      0.71      0.65       100
       orchid       0.60      0.37      0.46       100
        otter       0.03      0.01      0.01       100
    palm_tree       0.55      0.44      0.49       100
         pear       0.60      0.25      0.35       100
 pickup_truck       0.67      0.06      0.11       100
    pine_tree       0.22      0.15      0.18       100
        plain       0.85      0.71      0.77       100
        plate       0.35      0.49      0.40       100
        poppy       0.56      0.40      0.47       100
    porcupine       0.32      0.23      0.27       100
       possum       0.17      0.06      0.09       100
       rabbit       0.11      0.01      0.02       100
      raccoon       0.17      0.05      0.08       100
          ray       0.28      0.36      0.32       100
         road       0.82      0.69      0.75       100
       rocket       0.78      0.43      0.55       100
         rose       0.40      0.52      0.45       100
          sea       0.62      0.56      0.59       100
         seal       0.17      0.08      0.11       100
        shark       0.36      0.41      0.38       100
        shrew       0.16      0.26      0.20       100
        skunk       0.57      0.64      0.60       100
   skyscraper       0.75      0.44      0.55       100
        snail       0.25      0.13      0.17       100
        snake       0.17      0.22      0.19       100
       spider       0.41      0.30      0.34       100
     squirrel       0.00      0.00      0.00       100
    streetcar       0.26      0.41      0.32       100
    sunflower       0.90      0.64      0.75       100
 sweet_pepper       0.45      0.25      0.32       100
        table       0.43      0.10      0.16       100
         tank       0.34      0.38      0.36       100
    telephone       0.43      0.44      0.44       100
   television       0.65      0.32      0.43       100
        tiger       0.10      0.64      0.18       100
      tractor       0.37      0.46      0.41       100
        train       0.38      0.06      0.10       100
        trout       0.47      0.55      0.51       100
        tulip       0.29      0.19      0.23       100
       turtle       0.14      0.09      0.11       100
     wardrobe       0.72      0.54      0.62       100
        whale       0.50      0.16      0.24       100
  willow_tree       0.27      0.28      0.28       100
         wolf       0.20      0.18      0.19       100
        woman       0.18      0.06      0.09       100
         worm       0.27      0.15      0.19       100

     accuracy                           0.31     10000
    macro avg       0.38      0.31      0.31     10000
 weighted avg       0.38      0.31      0.31     10000
</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<ul>
<li>실제 데이터 확인</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:437,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764618056,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="54eb9a96-3b26-4dba-e787-1569ee645278" data-execution_count="60">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>rand_idx <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="bu">len</span>(y_pred_arg))</span>
<span id="cb68-2"><a href="#cb68-2"></a>test_idx <span class="op">=</span> test_y_arg[rand_idx]</span>
<span id="cb68-3"><a href="#cb68-3"></a>pred_idx <span class="op">=</span> y_pred_arg[rand_idx]</span>
<span id="cb68-4"><a href="#cb68-4"></a>class_prob <span class="op">=</span> np.floor( y_pred[rand_idx]<span class="op">*</span><span class="dv">100</span> )</span>
<span id="cb68-5"><a href="#cb68-5"></a></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="bu">print</span>(<span class="ss">f'idx = </span><span class="sc">{</span>rand_idx<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="bu">print</span>(<span class="ss">f'해당 인덱스의 이미지는 </span><span class="sc">{</span>label_dict[test_idx]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="bu">print</span>(<span class="ss">f'모델의 예측 : </span><span class="sc">{</span>label_dict[pred_idx]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb68-9"><a href="#cb68-9"></a><span class="bu">print</span>(<span class="ss">f'모델의 클래스별 확률 : '</span>)</span>
<span id="cb68-10"><a href="#cb68-10"></a><span class="bu">print</span>(<span class="st">'-------------------'</span>)</span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="cf">for</span> idx, val <span class="kw">in</span> <span class="bu">enumerate</span>( <span class="bu">list</span>(label_dict.values()) ) :</span>
<span id="cb68-12"><a href="#cb68-12"></a>    <span class="bu">print</span>(val, class_prob[idx])</span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="bu">print</span>(<span class="st">'================================================='</span>)</span>
<span id="cb68-14"><a href="#cb68-14"></a></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="cf">if</span> test_y_arg[rand_idx] <span class="op">==</span> y_pred_arg[rand_idx] :</span>
<span id="cb68-16"><a href="#cb68-16"></a>    <span class="bu">print</span>(<span class="st">'정답'</span>)</span>
<span id="cb68-17"><a href="#cb68-17"></a><span class="cf">else</span> :</span>
<span id="cb68-18"><a href="#cb68-18"></a>    <span class="bu">print</span>(<span class="st">'땡'</span>)</span>
<span id="cb68-19"><a href="#cb68-19"></a></span>
<span id="cb68-20"><a href="#cb68-20"></a>plt.imshow(test_x[rand_idx])</span>
<span id="cb68-21"><a href="#cb68-21"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>idx = 7957
해당 인덱스의 이미지는 keyboard
모델의 예측 : leopard
모델의 클래스별 확률 : 
-------------------
apple 0.0
aquarium_fish 0.0
baby 0.0
bear 3.0
beaver 7.0
bed 0.0
bee 0.0
beetle 0.0
bicycle 0.0
bottle 0.0
bowl 0.0
boy 0.0
bridge 9.0
bus 0.0
butterfly 0.0
camel 0.0
can 0.0
castle 1.0
caterpillar 0.0
cattle 3.0
chair 0.0
chimpanzee 9.0
clock 0.0
cloud 0.0
cockroach 0.0
couch 0.0
cra 0.0
crocodile 0.0
cup 0.0
dinosaur 2.0
dolphin 0.0
elephant 5.0
flatfish 0.0
forest 0.0
fox 0.0
girl 0.0
hamster 0.0
house 1.0
kangaroo 2.0
keyboard 0.0
lamp 0.0
lawn_mower 0.0
leopard 10.0
lion 0.0
lizard 0.0
lobster 0.0
man 0.0
maple_tree 0.0
motorcycle 0.0
mountain 0.0
mouse 1.0
mushroom 1.0
oak_tree 0.0
orange 0.0
orchid 0.0
otter 2.0
palm_tree 0.0
pear 0.0
pickup_truck 0.0
pine_tree 0.0
plain 0.0
plate 0.0
poppy 0.0
porcupine 1.0
possum 4.0
rabbit 0.0
raccoon 6.0
ray 0.0
road 0.0
rocket 0.0
rose 0.0
sea 0.0
seal 2.0
shark 0.0
shrew 2.0
skunk 0.0
skyscraper 0.0
snail 0.0
snake 0.0
spider 0.0
squirrel 3.0
streetcar 0.0
sunflower 0.0
sweet_pepper 0.0
table 0.0
tank 1.0
telephone 0.0
television 0.0
tiger 0.0
tractor 0.0
train 0.0
trout 0.0
tulip 0.0
turtle 0.0
wardrobe 0.0
whale 0.0
willow_tree 0.0
wolf 1.0
woman 0.0
worm 0.0
=================================================
땡</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-02-03-05. ImageAugmentation3_files/figure-html/cell-47-output-2.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>틀린 이미지만 확인해보기</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764669423,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="e49b1138-2ea5-4b82-b7ea-55d79ceaa327" data-execution_count="61">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>temp <span class="op">=</span> (test_y_arg <span class="op">==</span> y_pred_arg)</span>
<span id="cb70-2"><a href="#cb70-2"></a>false_idx <span class="op">=</span> np.where(temp<span class="op">==</span><span class="va">False</span>)[<span class="dv">0</span>]</span>
<span id="cb70-3"><a href="#cb70-3"></a>false_len <span class="op">=</span> <span class="bu">len</span>(false_idx)</span>
<span id="cb70-4"><a href="#cb70-4"></a>false_len</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>6920</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:769,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1694764700626,&quot;user&quot;:{&quot;displayName&quot;:&quot;김건영&quot;,&quot;userId&quot;:&quot;04338252548733078915&quot;},&quot;user_tz&quot;:-540}" data-outputid="38d6df97-e86c-4d2e-908b-5caa9fc5cb90" data-execution_count="63">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>rand_idx <span class="op">=</span> false_idx[np.random.randint(<span class="dv">0</span>, false_len)]</span>
<span id="cb72-2"><a href="#cb72-2"></a>test_idx <span class="op">=</span> test_y_arg[rand_idx]</span>
<span id="cb72-3"><a href="#cb72-3"></a>pred_idx <span class="op">=</span> y_pred_arg[rand_idx]</span>
<span id="cb72-4"><a href="#cb72-4"></a>class_prob <span class="op">=</span> np.floor( y_pred[rand_idx]<span class="op">*</span><span class="dv">100</span> )</span>
<span id="cb72-5"><a href="#cb72-5"></a></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="bu">print</span>(<span class="ss">f'idx = </span><span class="sc">{</span>rand_idx<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="bu">print</span>(<span class="ss">f'해당 인덱스의 이미지는 </span><span class="sc">{</span>label_dict[test_idx]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb72-8"><a href="#cb72-8"></a><span class="bu">print</span>(<span class="ss">f'모델의 예측 : </span><span class="sc">{</span>label_dict[pred_idx]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="bu">print</span>(<span class="ss">f'모델의 클래스별 확률 : '</span>)</span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="bu">print</span>(<span class="st">'-------------------'</span>)</span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="cf">for</span> idx, val <span class="kw">in</span> <span class="bu">enumerate</span>( <span class="bu">list</span>(label_dict.values()) ) :</span>
<span id="cb72-12"><a href="#cb72-12"></a>    <span class="bu">print</span>(val, class_prob[idx])</span>
<span id="cb72-13"><a href="#cb72-13"></a><span class="bu">print</span>(<span class="st">'================================================='</span>)</span>
<span id="cb72-14"><a href="#cb72-14"></a></span>
<span id="cb72-15"><a href="#cb72-15"></a><span class="cf">if</span> test_y_arg[rand_idx] <span class="op">==</span> y_pred_arg[rand_idx] :</span>
<span id="cb72-16"><a href="#cb72-16"></a>    <span class="bu">print</span>(<span class="st">'정답'</span>)</span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="cf">else</span> :</span>
<span id="cb72-18"><a href="#cb72-18"></a>    <span class="bu">print</span>(<span class="st">'땡'</span>)</span>
<span id="cb72-19"><a href="#cb72-19"></a></span>
<span id="cb72-20"><a href="#cb72-20"></a>plt.imshow(test_x[rand_idx] )</span>
<span id="cb72-21"><a href="#cb72-21"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>idx = 8604
해당 인덱스의 이미지는 camel
모델의 예측 : kangaroo
모델의 클래스별 확률 : 
-------------------
apple 0.0
aquarium_fish 0.0
baby 0.0
bear 0.0
beaver 3.0
bed 0.0
bee 0.0
beetle 0.0
bicycle 0.0
bottle 0.0
bowl 0.0
boy 0.0
bridge 0.0
bus 0.0
butterfly 0.0
camel 1.0
can 0.0
castle 0.0
caterpillar 0.0
cattle 12.0
chair 0.0
chimpanzee 0.0
clock 0.0
cloud 0.0
cockroach 0.0
couch 0.0
cra 0.0
crocodile 0.0
cup 0.0
dinosaur 1.0
dolphin 0.0
elephant 0.0
flatfish 0.0
forest 0.0
fox 14.0
girl 0.0
hamster 0.0
house 0.0
kangaroo 39.0
keyboard 0.0
lamp 0.0
lawn_mower 0.0
leopard 1.0
lion 0.0
lizard 0.0
lobster 0.0
man 0.0
maple_tree 0.0
motorcycle 0.0
mountain 0.0
mouse 0.0
mushroom 0.0
oak_tree 0.0
orange 0.0
orchid 0.0
otter 0.0
palm_tree 0.0
pear 0.0
pickup_truck 0.0
pine_tree 0.0
plain 0.0
plate 0.0
poppy 0.0
porcupine 1.0
possum 0.0
rabbit 1.0
raccoon 0.0
ray 0.0
road 0.0
rocket 0.0
rose 0.0
sea 0.0
seal 0.0
shark 0.0
shrew 5.0
skunk 0.0
skyscraper 0.0
snail 0.0
snake 0.0
spider 1.0
squirrel 0.0
streetcar 0.0
sunflower 0.0
sweet_pepper 0.0
table 0.0
tank 0.0
telephone 0.0
television 0.0
tiger 4.0
tractor 0.0
train 0.0
trout 0.0
tulip 0.0
turtle 0.0
wardrobe 0.0
whale 0.0
willow_tree 0.0
wolf 0.0
woman 0.0
worm 0.0
=================================================
땡</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2021-02-03-05. ImageAugmentation3_files/figure-html/cell-49-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../posts/image/2021-02-02-04. ImageAugmentation2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">03. image DA (2)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../posts/image/2021-02-05-06. DeepLearningwithMNIST.html" class="pagination-link">
        <span class="nav-page-text">05. MNIST</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>