<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="GC">
<meta name="dcterms.date" content="2024-01-21">

<title>Goldkiss - 00. Associate Review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Goldkiss</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">00. Associate Review</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">PRO</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>GC </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#문제-풀의-유의사항" id="toc-문제-풀의-유의사항" class="nav-link active" data-scroll-target="#문제-풀의-유의사항">문제 풀의 유의사항</a></li>
  <li><a href="#데이터-로드" id="toc-데이터-로드" class="nav-link" data-scroll-target="#데이터-로드">데이터 로드</a></li>
  <li><a href="#데이터-구성-확인" id="toc-데이터-구성-확인" class="nav-link" data-scroll-target="#데이터-구성-확인">데이터 구성 확인</a>
  <ul class="collapse">
  <li><a href="#voc_trt_perd_itg_cd-변수의-고유값-count" id="toc-voc_trt_perd_itg_cd-변수의-고유값-count" class="nav-link" data-scroll-target="#voc_trt_perd_itg_cd-변수의-고유값-count"><code>voc_trt_perd_itg_cd</code> 변수의 고유값 count</a></li>
  </ul></li>
  <li><a href="#불필요한-변수-삭제" id="toc-불필요한-변수-삭제" class="nav-link" data-scroll-target="#불필요한-변수-삭제">불필요한 변수 삭제</a></li>
  <li><a href="#데이터-결측치-처리" id="toc-데이터-결측치-처리" class="nav-link" data-scroll-target="#데이터-결측치-처리">데이터 결측치 처리</a></li>
  <li><a href="#cust_clas_itf_cd의-결측치를-최빈값으로-변경" id="toc-cust_clas_itf_cd의-결측치를-최빈값으로-변경" class="nav-link" data-scroll-target="#cust_clas_itf_cd의-결측치를-최빈값으로-변경"><code>cust_clas_itf_cd</code>의 결측치를 최빈값으로 변경</a></li>
  <li><a href="#age_itg_cd의-결측치를-중앙값으로-변경하고-데이터-타입을-정수로-변경" id="toc-age_itg_cd의-결측치를-중앙값으로-변경하고-데이터-타입을-정수로-변경" class="nav-link" data-scroll-target="#age_itg_cd의-결측치를-중앙값으로-변경하고-데이터-타입을-정수로-변경"><code>age_itg_cd</code>의 결측치를 중앙값으로 변경하고 데이터 타입을 정수로 변경</a></li>
  <li><a href="#cont_sttus_itg_cd의-null값과-cust_dtl_ctg_itg_cd의-null-값을-최빈값으로-변경" id="toc-cont_sttus_itg_cd의-null값과-cust_dtl_ctg_itg_cd의-null-값을-최빈값으로-변경" class="nav-link" data-scroll-target="#cont_sttus_itg_cd의-null값과-cust_dtl_ctg_itg_cd의-null-값을-최빈값으로-변경"><code>cont_sttus_itg_cd</code>의 null값과 <code>cust_dtl_ctg_itg_cd</code>의 null 값을 최빈값으로 변경</a></li>
  <li><a href="#라벨-인코딩-원핫-인코딩starstarstar" id="toc-라벨-인코딩-원핫-인코딩starstarstar" class="nav-link" data-scroll-target="#라벨-인코딩-원핫-인코딩starstarstar">라벨 인코딩, 원핫 인코딩(<span class="math inline">\(\star\star\star\)</span>)</a>
  <ul class="collapse">
  <li><a href="#라벨인코딩" id="toc-라벨인코딩" class="nav-link" data-scroll-target="#라벨인코딩">라벨인코딩</a></li>
  </ul></li>
  <li><a href="#범주형-컬럼-one_hot_encoding" id="toc-범주형-컬럼-one_hot_encoding" class="nav-link" data-scroll-target="#범주형-컬럼-one_hot_encoding">범주형 컬럼 one_hot_encoding</a></li>
  <li><a href="#x.-y-데이터-분리" id="toc-x.-y-데이터-분리" class="nav-link" data-scroll-target="#x.-y-데이터-분리">x. y 데이터 분리</a></li>
  <li><a href="#데이터-스케일링" id="toc-데이터-스케일링" class="nav-link" data-scroll-target="#데이터-스케일링">데이터 스케일링</a></li>
  <li><a href="#로지스틱-모델-설계" id="toc-로지스틱-모델-설계" class="nav-link" data-scroll-target="#로지스틱-모델-설계">로지스틱 모델 설계</a></li>
  <li><a href="#결과-시각화" id="toc-결과-시각화" class="nav-link" data-scroll-target="#결과-시각화">결과 시각화</a></li>
  <li><a href="#tree-모형-설계" id="toc-tree-모형-설계" class="nav-link" data-scroll-target="#tree-모형-설계">tree 모형 설계</a></li>
  <li><a href="#randomforest" id="toc-randomforest" class="nav-link" data-scroll-target="#randomforest">RandomForest</a></li>
  <li><a href="#xgboost" id="toc-xgboost" class="nav-link" data-scroll-target="#xgboost">XGBoost</a></li>
  <li><a href="#lightgbm" id="toc-lightgbm" class="nav-link" data-scroll-target="#lightgbm">lightgbm</a></li>
  <li><a href="#딥러닝-모델-설계" id="toc-딥러닝-모델-설계" class="nav-link" data-scroll-target="#딥러닝-모델-설계">딥러닝 모델 설계</a></li>
  <li><a href="#결과-시각화-1" id="toc-결과-시각화-1" class="nav-link" data-scroll-target="#결과-시각화-1">결과 시각화</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="문제-풀의-유의사항" class="level1">
<h1>문제 풀의 유의사항</h1>
<p><code>1</code> 반드시 답안을 작성하라는 셀안에 코드를 작성하기</p>
<p><code>2</code> 변수명이 제시된 경우 반드시 해당 변수명을 사용하기</p>
<p><code>3</code> 데이터를 분석 및 전처리한 후 머신러닝과 딥러닝으로 VOC를 제기한 고객의 해지여부를 예측하고 결과를 분석하세요.</p>
</section>
<section id="데이터-로드" class="level1">
<h1>데이터 로드</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"/content/voc_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="데이터-구성-확인" class="level1">
<h1>데이터 구성 확인</h1>
<div class="cell" data-outputid="7abf92a0-2c85-417d-dd1d-866cd0a18ee9" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 24 columns):
 #   Column                          Non-Null Count  Dtype 
---  ------                          --------------  ----- 
 0   voc_trt_perd_itg_cd             10000 non-null  object
 1   voc_prod_sbt_id                 10000 non-null  int64 
 2   voc_wjt_sorc_id                 10000 non-null  int64 
 3   voc_type_itg_cd                 10000 non-null  int64 
 4   voc_sttus_itg_cd                10000 non-null  int64 
 5   voc_trt_reslt_itg_cd            10000 non-null  object
 6   cust_clas_itg_cd                10000 non-null  object
 7   bprod_sbt_id                    10000 non-null  int64 
 8   age_itg_cd                      10000 non-null  object
 9   cont_sttus_itg_cd               10000 non-null  object
 10  new_date                        10000 non-null  int64 
 11  opn_nfl_chg_date                10000 non-null  int64 
 12  cust_dtl_ctg_itg_cd             10000 non-null  object
 13  voc_trt_degr_div_itg_cd         10000 non-null  int64 
 14  voc_dupl_tmscnt                 10000 non-null  int64 
 15  oos_cause_type_itg_cd           10000 non-null  object
 16  voc_trt_need_time_itg_cd        10000 non-null  int64 
 17  engt_cperd_type_itg_cd          10000 non-null  object
 18  engt_tgt_div_itg_cd             10000 non-null  object
 19  cont_fns_pam_date               10000 non-null  int64 
 20  voc_mis_pbls_yn                 10000 non-null  object
 21  fclt_oos_yn                     10000 non-null  object
 22  cust_snsry_base_conf_need_time  10000 non-null  int64 
 23  trm_yn                          10000 non-null  object
dtypes: int64(12), object(12)
memory usage: 1.8+ MB</code></pre>
</div>
</div>
<div class="cell" data-outputid="db0d7c06-db90-4a2c-f154-e74aa7d43f23" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

  <div id="df-dbe5b268-857a-4e09-8759-f66aaad260fb" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">voc_prod_sbt_id</th>
<th data-quarto-table-cell-role="th">voc_wjt_sorc_id</th>
<th data-quarto-table-cell-role="th">voc_type_itg_cd</th>
<th data-quarto-table-cell-role="th">voc_sttus_itg_cd</th>
<th data-quarto-table-cell-role="th">bprod_sbt_id</th>
<th data-quarto-table-cell-role="th">new_date</th>
<th data-quarto-table-cell-role="th">opn_nfl_chg_date</th>
<th data-quarto-table-cell-role="th">voc_trt_degr_div_itg_cd</th>
<th data-quarto-table-cell-role="th">voc_dupl_tmscnt</th>
<th data-quarto-table-cell-role="th">voc_trt_need_time_itg_cd</th>
<th data-quarto-table-cell-role="th">cont_fns_pam_date</th>
<th data-quarto-table-cell-role="th">cust_snsry_base_conf_need_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1.000000e+04</td>
<td>10000.00000</td>
<td>10000.00000</td>
<td>10000.000000</td>
<td>1.000000e+04</td>
<td>1.000000e+04</td>
<td>1.000000e+04</td>
<td>10000.000000</td>
<td>10000.000000</td>
<td>10000.000000</td>
<td>1.000000e+04</td>
<td>10000.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>9.907267e+08</td>
<td>1578.29170</td>
<td>10008.52360</td>
<td>10002.043400</td>
<td>8.838173e+08</td>
<td>1.744283e+07</td>
<td>1.744505e+07</td>
<td>20001.074200</td>
<td>0.008800</td>
<td>10002.656800</td>
<td>7.004469e+07</td>
<td>193.88010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.005780e+08</td>
<td>1078.63717</td>
<td>1.57927</td>
<td>0.314843</td>
<td>3.214229e+08</td>
<td>6.849207e+06</td>
<td>6.850077e+06</td>
<td>0.262109</td>
<td>0.103555</td>
<td>6.576864</td>
<td>3.863802e+07</td>
<td>6970.03853</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-9.980000e+02</td>
<td>126.00000</td>
<td>10003.00000</td>
<td>10002.000000</td>
<td>-9.980000e+02</td>
<td>1.010100e+04</td>
<td>1.010100e+04</td>
<td>20001.000000</td>
<td>0.000000</td>
<td>10001.000000</td>
<td>2.001063e+07</td>
<td>0.00000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>1.000782e+09</td>
<td>360.00000</td>
<td>10009.00000</td>
<td>10002.000000</td>
<td>1.000003e+09</td>
<td>2.008053e+07</td>
<td>2.008123e+07</td>
<td>20001.000000</td>
<td>0.000000</td>
<td>10001.000000</td>
<td>2.021102e+07</td>
<td>0.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>1.001028e+09</td>
<td>2056.00000</td>
<td>10009.00000</td>
<td>10002.000000</td>
<td>1.000749e+09</td>
<td>2.014121e+07</td>
<td>2.015031e+07</td>
<td>20001.000000</td>
<td>0.000000</td>
<td>10001.000000</td>
<td>9.999123e+07</td>
<td>0.00000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.001036e+09</td>
<td>2153.00000</td>
<td>10009.00000</td>
<td>10002.000000</td>
<td>1.001044e+09</td>
<td>2.018010e+07</td>
<td>2.018032e+07</td>
<td>20001.000000</td>
<td>0.000000</td>
<td>10001.000000</td>
<td>9.999123e+07</td>
<td>0.00000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.001079e+09</td>
<td>3856.00000</td>
<td>10017.00000</td>
<td>10005.000000</td>
<td>1.001078e+09</td>
<td>2.020041e+07</td>
<td>2.020041e+07</td>
<td>20002.000000</td>
<td>3.000000</td>
<td>10038.000000</td>
<td>9.999123e+07</td>
<td>367991.00000</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dbe5b268-857a-4e09-8759-f66aaad260fb')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dbe5b268-857a-4e09-8759-f66aaad260fb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dbe5b268-857a-4e09-8759-f66aaad260fb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0cf8c72b-e158-4117-833c-27601455f148">
  <button class="colab-df-quickchart" onclick="quickchart('df-0cf8c72b-e158-4117-833c-27601455f148')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0cf8c72b-e158-4117-833c-27601455f148 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div>
</div>
<section id="voc_trt_perd_itg_cd-변수의-고유값-count" class="level2">
<h2 class="anchored" data-anchor-id="voc_trt_perd_itg_cd-변수의-고유값-count"><code>voc_trt_perd_itg_cd</code> 변수의 고유값 count</h2>
<div class="cell" data-outputid="561501b5-6157-4e57-a048-2d0429559ef9" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"voc_trt_perd_itg_cd"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>_        5422
10000    4283
10001     163
10002      58
10003      25
10004      16
10005      10
10006       6
10008       3
10009       3
10016       2
10011       2
10012       2
10007       2
10014       1
10013       1
10015       1
Name: voc_trt_perd_itg_cd, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-outputid="422bf03b-a9f2-4559-b403-018be9d57db7" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"voc_trt_perd_itg_cd"</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>_        0.5422
10000    0.4283
10001    0.0163
10002    0.0058
10003    0.0025
10004    0.0016
10005    0.0010
10006    0.0006
10008    0.0003
10009    0.0003
10016    0.0002
10011    0.0002
10012    0.0002
10007    0.0002
10014    0.0001
10013    0.0001
10015    0.0001
Name: voc_trt_perd_itg_cd, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="불필요한-변수-삭제" class="level1">
<h1>불필요한 변수 삭제</h1>
<div class="cell" data-outputid="cc1bc7c4-8dbe-48c5-f8d7-dbda3c93deb0" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d_c <span class="op">=</span> [<span class="st">"voc_trt_perd_itg_cd"</span>, <span class="st">"voc_trt_reslt_itg_cd"</span>, <span class="st">"oos_cause_type_itg_cd"</span>, <span class="st">"engt_cperd_type_itg_cd"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"engt_tgt_div_itg_cd"</span>, <span class="st">"fclt_oos_yn"</span>, <span class="st">"voc_mis_pbls_yn"</span>, <span class="st">"new_date"</span>, <span class="st">"opn_nfl_chg_date"</span>, <span class="st">'cont_fns_pam_date'</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.drop(d_c, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 14 columns):
 #   Column                          Non-Null Count  Dtype 
---  ------                          --------------  ----- 
 0   voc_prod_sbt_id                 10000 non-null  int64 
 1   voc_wjt_sorc_id                 10000 non-null  int64 
 2   voc_type_itg_cd                 10000 non-null  int64 
 3   voc_sttus_itg_cd                10000 non-null  int64 
 4   cust_clas_itg_cd                10000 non-null  object
 5   bprod_sbt_id                    10000 non-null  int64 
 6   age_itg_cd                      10000 non-null  object
 7   cont_sttus_itg_cd               10000 non-null  object
 8   cust_dtl_ctg_itg_cd             10000 non-null  object
 9   voc_trt_degr_div_itg_cd         10000 non-null  int64 
 10  voc_dupl_tmscnt                 10000 non-null  int64 
 11  voc_trt_need_time_itg_cd        10000 non-null  int64 
 12  cust_snsry_base_conf_need_time  10000 non-null  int64 
 13  trm_yn                          10000 non-null  object
dtypes: int64(9), object(5)
memory usage: 1.1+ MB</code></pre>
</div>
</div>
</section>
<section id="데이터-결측치-처리" class="level1">
<h1>데이터 결측치 처리</h1>
<p><code>1</code> DataFrame replace 함수를 사용해서 모든 컬럼에 대해 <code>_</code>값을 null로 변경</p>
<p><code>2</code> Null 표현 : np.nan</p>
<p><code>3</code> <code>inplace = True</code> 사용</p>
<p><code>4</code> 컬럼별 <code>Null</code> count</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df1.replace(<span class="st">"_"</span>, np.nan,inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="8eb6b751-d4d2-4c8d-f189-55fee6a39881" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df1.isna().<span class="bu">sum</span>() <span class="co">## 이 부분 count로 하면 안됌</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>voc_prod_sbt_id                      0
voc_wjt_sorc_id                      0
voc_type_itg_cd                      0
voc_sttus_itg_cd                     0
cust_clas_itg_cd                  1934
bprod_sbt_id                         0
age_itg_cd                        2129
cont_sttus_itg_cd                 1168
cust_dtl_ctg_itg_cd               1168
voc_trt_degr_div_itg_cd              0
voc_dupl_tmscnt                      0
voc_trt_need_time_itg_cd             0
cust_snsry_base_conf_need_time       0
trm_yn                               0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="cust_clas_itf_cd의-결측치를-최빈값으로-변경" class="level1">
<h1><code>cust_clas_itf_cd</code>의 결측치를 최빈값으로 변경</h1>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> df1.cust_clas_itg_cd.mode()[<span class="dv">0</span>] <span class="co">## 인덱스 넘버를 명시해주어야함</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df1.cust_clas_itg_cd.fillna(m, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="a089f96b-c847-43f2-f716-5768dde214fa" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df1.cust_clas_itg_cd.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="age_itg_cd의-결측치를-중앙값으로-변경하고-데이터-타입을-정수로-변경" class="level1">
<h1><code>age_itg_cd</code>의 결측치를 중앙값으로 변경하고 데이터 타입을 정수로 변경</h1>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> df1.age_itg_cd.median()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df1.age_itg_cd.fillna(m2, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="5ac2f14d-f0da-4399-dab9-fa076e1d7917" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df1.age_itg_cd.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df1.age_itg_cd <span class="op">=</span> df1.age_itg_cd.astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cont_sttus_itg_cd의-null값과-cust_dtl_ctg_itg_cd의-null-값을-최빈값으로-변경" class="level1">
<h1><code>cont_sttus_itg_cd</code>의 null값과 <code>cust_dtl_ctg_itg_cd</code>의 null 값을 최빈값으로 변경</h1>
<div class="cell" data-outputid="7c161014-0c39-408b-951b-86a824dbc247" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="op">=</span> df1.cont_sttus_itg_cd.mode()[<span class="dv">0</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>m4 <span class="op">=</span> df1.cust_dtl_ctg_itg_cd.mode()[<span class="dv">0</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>df1.cont_sttus_itg_cd.fillna(m3, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>df1.cust_dtl_ctg_itg_cd.fillna(m4, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df1.cont_sttus_itg_cd.isna().<span class="bu">sum</span>()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>df1.cust_dtl_ctg_itg_cd.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="라벨-인코딩-원핫-인코딩starstarstar" class="level1">
<h1>라벨 인코딩, 원핫 인코딩(<span class="math inline">\(\star\star\star\)</span>)</h1>
<p><code>Object</code> 데이터 타입을 가지는 열들을 선택하여 <code>cat_cols</code>라는 변수에 저장</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cat_cols  <span class="op">=</span> df1.select_dtypes(<span class="st">"O"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cat_cols.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="라벨인코딩" class="level2">
<h2 class="anchored" data-anchor-id="라벨인코딩">라벨인코딩</h2>
<p>cat_cols 데이터프레임에서 <code>cust_clas_itg_cd</code> 열의 범주형 데이터를 숫자로 인코딩하고, 그 결과를 <code>le_cust_clas_itg_cd</code> 열에 저장</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>cat_cols[<span class="st">"le_cust_clas_itg_cd"</span>] <span class="op">=</span> le.fit_transform(cat_cols[<span class="st">"cust_clas_itg_cd"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="57cc70e0-72a2-42a9-ed83-bd32ab4da642" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cat_cols.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

  <div id="df-2a781a72-fab3-4305-b7b6-e9d0957c25eb" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cust_clas_itg_cd</th>
<th data-quarto-table-cell-role="th">cont_sttus_itg_cd</th>
<th data-quarto-table-cell-role="th">cust_dtl_ctg_itg_cd</th>
<th data-quarto-table-cell-role="th">trm_yn</th>
<th data-quarto-table-cell-role="th">le_cust_clas_itg_cd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>F</td>
<td>10001</td>
<td>10003</td>
<td>N</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>G</td>
<td>10001</td>
<td>10002</td>
<td>N</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>G</td>
<td>10001</td>
<td>10003</td>
<td>N</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>L</td>
<td>10001</td>
<td>90024</td>
<td>N</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>G</td>
<td>10001</td>
<td>90024</td>
<td>N</td>
<td>1</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2a781a72-fab3-4305-b7b6-e9d0957c25eb')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2a781a72-fab3-4305-b7b6-e9d0957c25eb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2a781a72-fab3-4305-b7b6-e9d0957c25eb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-715e7ba5-025c-4512-8eea-eae19c1d57b9">
  <button class="colab-df-quickchart" onclick="quickchart('df-715e7ba5-025c-4512-8eea-eae19c1d57b9')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-715e7ba5-025c-4512-8eea-eae19c1d57b9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div>
</div>
</section>
</section>
<section id="범주형-컬럼-one_hot_encoding" class="level1">
<h1>범주형 컬럼 one_hot_encoding</h1>
<p><code>1</code> 범주형 컬럼을 찾아 cat_columns에 저장</p>
<p><code>2</code> Pandas의 get_dummies 함수 사용</p>
<p><code>3</code> 대상 데이터프레임 : df1</p>
<p><code>4</code> columns = <code>cat_columns</code></p>
<p><code>5</code> drop_first = True</p>
<p><code>6</code> 해당 전처리가 반영된 결과를 <code>df1</code> 데이터 프레임에 저장</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cat_columns <span class="op">=</span> df1.select_dtypes(<span class="st">"O"</span>).columns.values.tolist()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.get_dummies(df1, columns <span class="op">=</span> cat_columns, drop_first <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="x.-y-데이터-분리" class="level1">
<h1>x. y 데이터 분리</h1>
<p><code>1</code> 대상 데이터프레임 : df1</p>
<p><code>2</code> 훈련 데이터셋 label : y_train, 훈련 데이터셋 Feature : X_train</p>
<p><code>3</code> 테스트 데이터셋 label : y_test, 테스트 데이터셋 Feature : X_test</p>
<p><code>4</code> X, y, test_size=0.2, stratify=y, random_state=0</p>
<p><code>5</code> 사이킷런 train_test_split 함수 사용</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">"trm_yn_Y"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df1.drop(target, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df1[target]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, stratify <span class="op">=</span> y, random_state <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="데이터-스케일링" class="level1">
<h1>데이터 스케일링</h1>
<p><code>1</code> 사이킷런의 MinMaxScaler() 함수 사용</p>
<p><code>2</code> MinMaxScaler 객체를 초기화하고 mms 변수에 저장</p>
<p><code>3</code> 훈련 데이터 ’X_train’을 최소-최대 스케일링하여 변환, fit_transform 메서드 적용</p>
<p><code>4</code> 테스트 데이터 ’X_test’를 훈련 데이터에 맞춰 스케일링, transform 메서드 적용</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mms <span class="op">=</span> MinMaxScaler()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> mms.fit_transform(X_train)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> mms.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="로지스틱-모델-설계" class="level1">
<h1>로지스틱 모델 설계</h1>
<p><code>1</code> 규제강도 C : 1.0으로 설정</p>
<p><code>2</code> 계산에 사용할 작업수 <code>max_iter</code> : 2000으로 설정</p>
<p><code>3</code> 훈련 데이터셋 학습</p>
<p><code>4</code> X_test에 대한 예측 정확도를 계산</p>
<div class="cell" data-outputid="bfbedb2f-1e7d-46e6-ac15-bf03f9bd929f" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>logit <span class="op">=</span> LogisticRegression(C <span class="op">=</span> <span class="fl">1.0</span>, max_iter <span class="op">=</span> <span class="dv">2000</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>logit.fit(X_train, y_train)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>logit_pred <span class="op">=</span> logit.predict(X_test)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> <span class="op">*</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, logit_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0.978</code></pre>
</div>
</div>
</section>
<section id="결과-시각화" class="level1">
<h1>결과 시각화</h1>
<p><code>-</code> <code>heatmap</code>과 <code>classification_report</code>를 사용</p>
<ul>
<li><p><code>cf_matrix</code> 변수에 <code>confusion_matrix</code> 저장</p></li>
<li><p>heatmap 옵션 : <code>annot = True</code>, <code>fmt = "d"</code></p></li>
<li><p><code>y_test</code>와 <code>y_pred</code>를 비교하여 성능지표 출력</p></li>
</ul>
<div class="cell" data-outputid="19d3f2c1-c555-4c09-abb2-b0ac23837bab" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>cf_matrix <span class="op">=</span> confusion_matrix(y_test, logit_pred)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrix, annot <span class="op">=</span> <span class="va">True</span>, fmt <span class="op">=</span> <span class="st">"d"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, logit_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.98      1.00      0.99      1955
           1       1.00      0.02      0.04        45

    accuracy                           0.98      2000
   macro avg       0.99      0.51      0.52      2000
weighted avg       0.98      0.98      0.97      2000
</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-21-00. Associate review_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tree-모형-설계" class="level1">
<h1>tree 모형 설계</h1>
<div class="cell" data-outputid="8042f5fa-6c4e-4de2-ad61-185c841d8a8c" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> DecisionTreeClassifier(max_depth <span class="op">=</span> <span class="dv">10</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>tree.fit(X_train, y_train)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>tree_pred <span class="op">=</span> tree.predict(X_test)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, tree_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0.9705</code></pre>
</div>
</div>
</section>
<section id="randomforest" class="level1">
<h1>RandomForest</h1>
<div class="cell" data-outputid="275c2ec2-dc15-402d-db83-ffb0927e9708" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier(max_depth <span class="op">=</span> <span class="dv">10</span>, n_estimators <span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>rf.fit(X_train, y_train)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>rf_pred <span class="op">=</span> rf.predict(X_test)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, rf_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0.978</code></pre>
</div>
</div>
</section>
<section id="xgboost" class="level1">
<h1>XGBoost</h1>
<div class="cell" data-outputid="0415ffd2-d19d-4122-d095-1baa650075e2" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> XGBClassifier(max_depth <span class="op">=</span> <span class="dv">10</span>, n_estimators <span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>xg.fit(X_train, y_train)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>xg_pred <span class="op">=</span>  xg.predict(X_test)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, xg_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0.974</code></pre>
</div>
</div>
</section>
<section id="lightgbm" class="level1">
<h1>lightgbm</h1>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="a0373461-c240-4673-e9af-66c410e9d637" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lightgbm <span class="im">import</span> LGBMClassifier</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>lg <span class="op">=</span> LGBMClassifier(max_depth <span class="op">=</span> <span class="dv">5</span>, n_estimators <span class="op">=</span> <span class="dv">10</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>lgbm <span class="op">=</span>lg.fit(X_train, y_train)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>lg_pred <span class="op">=</span> lgbm.predict(X_test)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, lg_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0.9775</code></pre>
</div>
</div>
</section>
<section id="딥러닝-모델-설계" class="level1">
<h1>딥러닝 모델 설계</h1>
<p><code>1</code> Tensoflow의 Sequential() 함수를 사용하여 model로 저장하세요.</p>
<p><code>2</code> 첫번째 Hidden Layer : unit 64, activation=‘relu’, input_shape=(34,) 입력</p>
<p><code>3</code> 두번째 Hidden Layer : unit 32 , activation=‘relu’</p>
<p><code>4</code> 세번째 Hidden Layer : unit 16 , activation=‘relu’</p>
<p><code>5</code> 각 Hidden Layer 마다 Dropout 0.2 비율로 되도록 하세요.</p>
<p><code>6</code> 마지막 Dense에서 ‘sigmoid’ 설정하세요. (0.5 이하이면 정상, 아니면 해지)</p>
<p><code>7</code> 옵티마이저는 adam, 손실함수는 binary_crossentropy를 사용하세요.</p>
<p><code>8</code> EarlyStopping 콜백으로 정해진 epoch 동안 모니터링 지표가 향상되지 않을 때 훈련을 중지하도록 설정하세요 (모니터링 지표 : val_loss)</p>
<p><code>9</code> ModelCheckpoint 콜백으로 validation performance가 좋은 모델을 ‘my_checkpoint.ckpt’ 파일로 저장하세요.(모니터링 지표 : val_loss)</p>
<p><code>11</code> EarlyStopping 객체는 es 변수에 ModelCheckpoint 객체는 mc 변수에 저장해서 활용해 주세요.</p>
<p><code>12</code> 학습정보는 history 변수에 저장하세요.</p>
<div class="cell" data-outputid="522dd5dd-81a9-4571-cb54-7fbc89320636" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.backend <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras. callbacks <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">64</span>, activation  <span class="op">=</span> <span class="st">"relu"</span>, input_shape <span class="op">=</span> (<span class="dv">34</span>, )))</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">32</span>, activation  <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">16</span>, activation  <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> <span class="st">"sigmoid"</span>))</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> Adam(<span class="fl">0.01</span>), loss <span class="op">=</span> <span class="st">"binary_crossentropy"</span>)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>es <span class="op">=</span>  EarlyStopping(monitor <span class="op">=</span> <span class="st">"val_loss"</span>, mode  <span class="op">=</span> <span class="st">"min"</span>, verbose <span class="op">=</span> <span class="dv">1</span>, patience <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> ModelCheckpoint(mode <span class="op">=</span> <span class="st">"min"</span>, filepath <span class="op">=</span> <span class="st">"my_checkpoint.ckpt"</span>,monitor <span class="op">=</span> <span class="st">"val_loss"</span>, save_best_only<span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, callbacks <span class="op">=</span> [es, mc], epochs <span class="op">=</span> <span class="dv">30</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                                batch_size  <span class="op">=</span> <span class="dv">1024</span>, validation_data <span class="op">=</span> (X_test, y_test), verbose <span class="op">=</span> <span class="dv">1</span>).history</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/30
7/8 [=========================&gt;....] - ETA: 0s - loss: 0.3841 
Epoch 1: val_loss improved from inf to 0.13571, saving model to my_checkpoint.ckpt
8/8 [==============================] - 3s 215ms/step - loss: 0.3572 - val_loss: 0.1357
Epoch 2/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1396
Epoch 2: val_loss did not improve from 0.13571
8/8 [==============================] - 0s 8ms/step - loss: 0.1725 - val_loss: 0.1409
Epoch 3/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1794
Epoch 3: val_loss improved from 0.13571 to 0.10512, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 117ms/step - loss: 0.1367 - val_loss: 0.1051
Epoch 4/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1164
Epoch 4: val_loss improved from 0.10512 to 0.09992, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 118ms/step - loss: 0.1232 - val_loss: 0.0999
Epoch 5/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.0769
Epoch 5: val_loss improved from 0.09992 to 0.09892, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 112ms/step - loss: 0.1127 - val_loss: 0.0989
Epoch 6/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1192
Epoch 6: val_loss improved from 0.09892 to 0.09582, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 115ms/step - loss: 0.1106 - val_loss: 0.0958
Epoch 7/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1109
Epoch 7: val_loss improved from 0.09582 to 0.09456, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 117ms/step - loss: 0.1053 - val_loss: 0.0946
Epoch 8/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1078
Epoch 8: val_loss improved from 0.09456 to 0.09330, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 116ms/step - loss: 0.1051 - val_loss: 0.0933
Epoch 9/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.0928
Epoch 9: val_loss improved from 0.09330 to 0.09210, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 116ms/step - loss: 0.1004 - val_loss: 0.0921
Epoch 10/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1070
Epoch 10: val_loss improved from 0.09210 to 0.09164, saving model to my_checkpoint.ckpt
8/8 [==============================] - 1s 111ms/step - loss: 0.0985 - val_loss: 0.0916
Epoch 11/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1130
Epoch 11: val_loss did not improve from 0.09164
8/8 [==============================] - 0s 8ms/step - loss: 0.0975 - val_loss: 0.0922
Epoch 12/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.0851
Epoch 12: val_loss did not improve from 0.09164
8/8 [==============================] - 0s 9ms/step - loss: 0.0962 - val_loss: 0.0930
Epoch 13/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.1194
Epoch 13: val_loss did not improve from 0.09164
8/8 [==============================] - 0s 8ms/step - loss: 0.0949 - val_loss: 0.0963
Epoch 14/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.0872
Epoch 14: val_loss did not improve from 0.09164
8/8 [==============================] - 0s 10ms/step - loss: 0.0957 - val_loss: 0.0950
Epoch 15/30
1/8 [==&gt;...........................] - ETA: 0s - loss: 0.0888
Epoch 15: val_loss did not improve from 0.09164
8/8 [==============================] - 0s 10ms/step - loss: 0.0921 - val_loss: 0.0958
Epoch 15: early stopping</code></pre>
</div>
</div>
</section>
<section id="결과-시각화-1" class="level1">
<h1>결과 시각화</h1>
<div class="cell" data-outputid="55e45b9c-c004-47c8-98a0-0cb1520912f7" data-execution_count="39">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span>  matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">"loss"</span>], <span class="st">"--o"</span>, label <span class="op">=</span> <span class="st">"train_loss"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>plt.plot(history[<span class="st">"val_loss"</span>], <span class="st">"--o"</span>, label <span class="op">=</span> <span class="st">"val_loss"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-21-00. Associate review_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="135e0394-77ca-494d-cd89-9ad39d86dc02" data-execution_count="55">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> np.where(model.predict(X_test) <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>63/63 [==============================] - 0s 3ms/step</code></pre>
</div>
</div>
<div class="cell" data-outputid="9650c6fe-355d-4e4c-8cbe-b23900113f77" data-execution_count="56">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion_matrix(y_test, pred),</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                        annot <span class="op">=</span> <span class="va">True</span>, fmt <span class="op">=</span> <span class="st">"3d"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, pred))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1955    0]
 [  45    0]]
              precision    recall  f1-score   support

           0       0.98      1.00      0.99      1955
           1       0.00      0.00      0.00        45

    accuracy                           0.98      2000
   macro avg       0.49      0.50      0.49      2000
weighted avg       0.96      0.98      0.97      2000
</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2024-01-21-00. Associate review_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>